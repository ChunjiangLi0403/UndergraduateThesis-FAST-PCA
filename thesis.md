

## 引言

射电天文学是对来自天体和宇宙空间的无线电信号进行研究和分析的天文学分支，是天文学中的一个重要的研究方向。直到20世纪40年代，射电波段的观测才开始被应用于天文研究，并且快速的展示出了其研究潜力，为天文学的发展开拓了新的道路。20世纪60年代的四大天文发现——脉冲星、类星体、宇宙微波背景辐射、星际有机分子等都与射电天文息息相关。射电天文学已经成为现代天文学研究中不可或缺的重要组成部分。

射电望远镜是用于接收来自天体和宇宙空间的无线电信号的观测设备。由中国自主研发的500米口径球面射电望远镜（Five-hundred-meter Aperture Spherical radio Telescope, FAST）是目前世界上最大、最灵敏的单口径球面射电望远镜，被称为“中国天眼”。FAST的主要观测目标包括脉冲星与快速射电暴、中性氢观测以及其他谱线观测、参与射电干涉阵列联合测量（南仁东等，2017）、探索地外文明等等。目前，FAST已经发现了数百颗新脉冲星以及捕获了几次新快速射电暴，开始在射电天文研究中崭露头角。

射电频率干扰是射电望远镜采集到的来自于人类活动或者自然界的非天文信号。射电频率干扰普遍的存在于射电天文观测中，而近几十年来，随着人类对于射电波段开发的快速发展，射电望远镜在接收到目标科学信号的同时也接收到了大量的射电频率干扰(Njoku et al. 2005)。来自诸如地面设备、移动通讯、人造卫星等射电信号发射源的干扰，在许多射电望远镜的工作频段内都存在着强烈的干扰信号，甚至普遍的高于目标射电天文信号[flag]。由于FAST自身的超高分辨率，在接收到来自遥远宇宙中的天体信号的同时，也接受了大量来自地面和人造卫星的电磁干扰信号。尽管FAST已经采取了射电频段管理、射电静默区、超宽带应用以及基于软硬件的实时噪声处理系统等等削弱射电频率干扰的影响，并且还对周围的电磁环境尤其是卫星的射电辐射进行了监控，还是有大量的射电频率干扰尚未能够通过这些流程消除，混杂到我们接收到的数据之中。这些干扰信号对于FAST的数据分析和科学目标探测造成了很大的影响，因此，降低这些干扰信号的影响，成为尚年轻的FAST亟待解决的重要问题之一。

射电频率干扰对于射电天文科研工作的影响很大，一方面，强烈的射电频率干扰降低了射电信号的信噪比，使得准确的目标信号变得极其困难[flag]；其次，大部分射电频率干扰的信号仍是未知的，很难采用常规方法获得其在时域以及接收频域上的分布，这也就意味着很难对这些信号进行确切的补偿[flag]；此外，对于特定的目标源例如脉冲星而言，周期性的射电干扰会对其造成极大程度上的影响，不仅可能导致判断出错误的脉冲星候选体，也可能导致在脉冲星周期的拟合和判断上出现失误[flag]。

Baan在他的经典论文《RFI Mitigation in Radio Astronomy》（Baan et al. 2007）中给出了13种可能适用的降低射电天文学中射电频率干扰的方法，包括

1.对频谱环境进行测量，已确定和描述望远镜的背景射电干扰，并确定消除对应干扰源的方法；2. 通过进行射电频段管理方法来保护射电望远镜的工作频段；3. 为现有的和新一代的射电望远镜设置射电静默区；4. 利用智能认知和超宽带应用应对射电望远镜频谱挑战；5. 确定探测系统能够实现减少射电频率干扰的最佳地点；6. 利用射电频率干扰的特性进行数字滤波和子空间滤波；7. 使用宽频带频谱仪在时域和频域进行前相关阈值处理；8. 特定的射电频率干扰的自适应噪声消除；9. 使用阵列仪器进行空间滤波；10. 用统计学方法识别数据中的射电频率干扰并且消除这些干扰信号；11. 内置在软件相关器中的射电频率干扰消除算法；12. 应用于新建造的高数据率望远镜的自动后相关射电干扰检测和标记算法；13. 后相关处理过程中，利用地面源的边缘率与天体源的边缘率相比较来识别和消除信号

以上十三种方法在新望远镜的建设和望远镜数据处理的发展中都得到了具体的应用，尤其是通过滤波或者利用统计学方法实现射电频率干扰的明确和去除，在近十余年中得到了长足的发展。随着机器学习算法以及其他统计学算法在天文学和信号处理领域的应用和拓展，如何分离并且消除射电天文信号中的射电频率干扰，特别的进行实时且准确的计算、认知和消除射电频率干扰，成为了射电天文数据处理中新的挑战。

在以往的研究中，科学家们提出了大量的算法来去除射电信号中的嘈杂干扰，其中包括：

Fridman等人提出的射电频率干扰抑制系统（RFIMS），是一个针对射电望远镜实时信号采集的射电频率干扰消除系统（Fridman et al. 2001）；Ransom等人开发的PRESTO软件提供了一个基于信号的能量、均值、方差等等因素的射电频率干扰分离和消除算法rfifind，用于脉冲星探测中射电频率干扰的分离，对于周期性射电干扰或者脉冲型射电干扰均表现良好（Ransom et al. 2002）；空间滤波算法是使用基于多个波束、天线或接收机中的空间特征来消除近场的射电频率干扰的算法，通过空间滤波可以实现一些特征干扰信号的消除或者提高信号的信噪比（Leshem et al. 2000; Raza et al. 2002; Kocz et al. 2010; Hellbourg et al. 2012）；Guner等人提出的脉冲消减算法，能够实时的消减时域脉冲信号源(Guner et al. 2007)；Eatough等人提出了零色散测量技术（Zero-Dispertion-measure, zero-DM），在常规的消色散技术的基础上，通过计算每个时间样本中的所有频段通道的平均值并从时间样本中的每个单独频段通道中减去该平均值，实现零色散测量滤波，从而加强对于射电单脉冲或者快速射电暴等瞬态信号的灵敏度（Eatough et al. 2009）；Offringa等人提出了SumThreshold方法，在时域平面内进行曲面拟合，并且与将奇异值分解（Singular Value Decomposition, SVD）应用于射电信号处理中的效果进行比较（Offringa et al. 2010）；Czech等人利用主成分分析和核主成分分析（Kernel-PCA）的方法对一组由9个公共源组成的瞬态射电频率干扰数据进行性了统计性质的分析（Czech et al. 2017）并且提出了一种新的基于标签字典和隐马尔科夫模型的方法来识别瞬时射电频率干扰并且给出来源，实现了更高的分类精度（Czech et al. 2018）；An等人对应用于四个信号处理阶段：预防、预检测、预相关和后相关的不同射电频率干扰消除算法进行了比较和分析，并提出了如何合理安排四个阶段中消除算法的组合以实现最佳的分析策略（An et al. 2017）。

上述的种种方法往往采用各种技术来尝试检测和去除射电信号中干扰信号，而最近研究人员开始尝试从分离出来射电频率干扰信号的特征出发，寻找这些信号的可能来源。[flag:Yuan, Mao]他们首先将来自FAST超宽带接收器的射电信号以接收频率通道作为维度进行主成分分析，提取出主要的干扰信号成分；接着提出了一个分类程序，将射电频率干扰在频域上氛围窄带类型和宽带类型，在时域上分成了三种主要的类别：脉冲型，周期型以及随机型。其中脉冲型的射电干扰是一个或者一些强烈的短脉冲；周期型的射电干扰是具有明显周期型的，可重复的信号；随机型指的是没有明显的脉冲或者周期特征，呈现出较长期波动的信号。最后，将这些分类之后的信号记录在目录之中，以便对其进行进一步的统计分析。

本文试图在上述论文描述的方法上更进一步。首先，主成分分析算法是一个经典的统计学方法，不仅能够应用于时域信号的分离，也能够应用于谱线的分离，所以，我们尝试着在频谱上进行主成分分析，从另一个角度尝试获取不同的分离方式和分离结果；其次，在上述三种时域分类中，周期型的干扰信号对于科学目标的影响最为关键，同时对于强周期性的信号而言，其具有着明显的频谱特征，因此我们着重于窄带周期性信号的分析与研究。第二节将介绍将上述方法应用于FAST19波束接收器之后的结果和分析，第三节将介绍对原始数据转换到频域空间进行双重滤波之后再利用主成分分析进行分离的结果以及分析，在第四节中则讨论了一些其他可能进行的方法以及这些方法的制约之处，同时对未来的工作方向提出一些设想。

## 时域信号的主成分分析

1. 主成分分析方法介绍

主成分分析分析算法是一种常用的数据降维方法，其基本原理如下：

主成分分析法（Principal Component Analysis, PCA）的核心是对数据进行降维操作，即顺序的找到一组新的正交基，使得原数据在新的正交基上获得最大的方差，其内在含义是让这些新的正交成分能够最大程度上的表征原始数据的特征。将主成分分析应用于信号处理中时，根据选定的特征维度不同，进行主成分分析之后得到的降维数据也不尽相同。例如：如果将一段信号进行固定长度滑动窗口切片，将一个一维的时间序列重构成一个轨迹矩阵，以切片起始位置作为维度特征，能够提取出数据中最有特征的片段，从一定意义上说起到了降低噪声的作用[flag]；如果有多个探测器同时对一段信号进行探测，以这些不同的探测器作为特征，进行主成分分析，就能够重构出更加接近原始信号的时间序列[flag]。   

本次数据分析采用的数据是来自FAST19波束接收机接收到的脉冲星数据，工作频段是1GHz-1.5GHz，共有4096个频段通道，采样率为196.608\mu s，在实际的数据记录中每16个点进行一次平均，得到的实际采样率为3.1457ms[FAST技术文档]。考虑到存储和运行内存的条件，信号处理采用的数据每8192个记录点保存为一个文档，共得到这样的文档275个。因此，我们共得到275个数据矩阵，每个矩阵的数据包含从1GHz-1.5GHz分布的4096个频段通道，以及从0s-25.77s分布的8192个时域采样点。后文的所有数据分析均基于上述的数据。

为了将主成分分析方法应用到本数据集中，我们首先明确了需要选取并且降维的特征维度，即以每一个频段通道作为一个特征，对时域信号进行主成分分析。不同于前文举例的主成分分析方法在信号处理中的应用，以频段作为特征维度背后的物理意义是新生成的一组正交基将是各个频段信号的线性组合，即通过主成分分析，不仅得到的主成分能够表征一个相对特征的信号，对应被投影的基矢也能够表征这个特征信号在接收频段上的分布。通过对一个数据矩阵进行主成分分析，我们预期能够得到一组特征信号以及他们的基矢，从这些信号的时频特征和接收频段的分布，尝试去推断这些特征信号可能对应的射电发射源。[flag]

在本文中，主成分分析的实现是通过对原始数据的协方差矩阵进行特征值分解，选取其中最大的一系列特征值对应的特征向量作为基矢，获得原始数据在这些基矢上的投影作为分离出来的成分。算法实现如下：
信号数据可以表示为一个$n\times m$的矩阵$M(n\times m)$：

$$
M = ({\vec{x_1}, \vec{x_2}, \cdots, \vec{x_n}})^T \ \   (\vec{x_i} = (x_{i1}, \cdots, x_{im}))
$$

首先将信号矩阵$M$中心化，得到中心化的矩阵$M'$

$$
M' = ({\vec{x'_1}, \vec{x'_2}, \cdots, \vec{x'_n}})^T \ \  (\vec{x'_i} = \vec{x_i} - mean(\vec{x_i}))
$$

计算得到矩阵$M$的协方差矩阵$S(n\times n)$:

$$
S = \frac{1}{m}M'M'^T
$$

对协方差矩阵$S$进行特征值分解，按照特征值的大小进行排序，得到前$k$个特征值:

$$
\lambda_1, \cdots, \lambda_k
$$

以及他们对应的特征向量（base）:

$$
\vec{p_1}, \cdots, \vec{p_k}
$$

将数据矩阵投影到这些特征向量中，得到分离之后的主成分(component):

$$
c_i = p_iM
$$

定义这些主成分占原信号的比例(content):

$$
\alpha_i = \frac{\lambda_i}{\sum_{j = 0}^n \lambda_j}
$$

通过对一个特征信号的特征向量，主成分，和比例进行分析，就可以确定这一个特征信号的物理性质。

2. 对信号矩阵直接进行主成分分析

以第一份数据文件为例，首先观察数据的时域和频域特征：
![signal](https://user-images.githubusercontent.com/44969208/119221158-8c2c6780-bb20-11eb-8ae3-38d14f380fb0.png)
![spectrum](https://user-images.githubusercontent.com/44969208/119221164-977f9300-bb20-11eb-8627-1febb9919c13.png)
从时频信号图中，我们观察发现信号在1.15-1.2GHz波段存在着明显的强信号，根据其频段和谱线特征，我们能够基本确定这些强信号主要来自于空间人造卫星的电磁辐射。而从频率-频段图中，我们能够观察到一些比较明显的特征线，包括：频段在1.15-1.2GHz中的强卫星信号，频率在50Hz的宽带发射谱，频段在1.43GHz左右的中低频信号以及一系列低频的谱线，这些较强的信号的来源大多数是我们已知的，而为了探索并不能在图中明显显现出来的干扰成分，我们需要通过主成分分析将其中特征的信号提取出来进行进一步的分析。

利用前文所述的主成分分析算法将维度从4096维降到20维，下图展示了前几个主成分及他们对应的频段分布和成分占比：
![01component01](https://user-images.githubusercontent.com/44969208/119221433-fbef2200-bb21-11eb-9b65-1023cbe42e77.png)
![01component02](https://user-images.githubusercontent.com/44969208/119221703-1aa1e880-bb23-11eb-9d1c-d4935d4c3d99.png)
![01component03](https://user-images.githubusercontent.com/44969208/119221705-1b3a7f00-bb23-11eb-8311-f64a9fd7a539.png)
可以发现其频段主要分布在1.15-1.2GHz之间，也就是我们在频率-频段图中观察到的强卫星干扰信号的进一步分离。然而，直接使用主成分分析对信号矩阵进行处理得到的前20维数据中，除了下图所示的第12个主成分之外，均分布在1.15-1.2GHz之间，占据原信号的比例过30%，且信号的波形均比较杂乱，阻碍了进一步的分析。因此我们需要对数据进行进一步的分析和处理，从而发掘出在更微弱的信号部分的干扰特征。
![01component12](https://user-images.githubusercontent.com/44969208/119221531-6e600200-bb22-11eb-8013-4edc5969ca95.png)

于是，我们尝试将十个数据文件合并，共同进行主成分分析，得到的前几个主成分如下图所示：
![component01](https://user-images.githubusercontent.com/44969208/119221650-df071e80-bb22-11eb-92df-5d27efb2628c.png)
![component02](https://user-images.githubusercontent.com/44969208/119221672-fe05b080-bb22-11eb-9eac-1520734418f6.png)
![component03](https://user-images.githubusercontent.com/44969208/119221682-052cbe80-bb23-11eb-80ab-34664be5f5d7.png)
相比于单个数据文件得到的结果，加大了信号的长度之后，主成分信号开始表现出时域特征，信噪比得到了显著的增强。并且，我们观察到了具有比较显著的周期性特点的信号，在后文中，我们将对这种类型的信号进行进一步的分析和讨论。
![component16](https://user-images.githubusercontent.com/44969208/119221753-5ccb2a00-bb23-11eb-8007-2e5c5525e44d.png)

然而，在前20个主成分之中，依然有超过80%的成分观测频段分布集中在1.15-1.2GHz的卫星信号频段，这些信号或者已知，或者难以研究，并且FAST已经开始对人造卫星的射频干扰进行系统的研究，不作为本文的主要研究对象。于是，我们对原数据进行观测频段上的选择，仅保留频段在1.25-1.5GHz中间的信号，也就是仅保留后2048个数据维度，再进行主成分分析，得到的前几个主成分如下图所示：
![filteredbychannel01](https://user-images.githubusercontent.com/44969208/119221821-cfd4a080-bb23-11eb-8fae-a74cff7b84f5.png)
![filteredbychannel02](https://user-images.githubusercontent.com/44969208/119221822-d236fa80-bb23-11eb-9832-3868abffb859.png)
![filteredbychannel03](https://user-images.githubusercontent.com/44969208/119221823-d400be00-bb23-11eb-8193-39a6bfd142f9.png)
![filteredbychannel04](https://user-images.githubusercontent.com/44969208/119221841-e4189d80-bb23-11eb-826f-85ed5ffbc559.png)
通过比较可以发现此处的第四个主成分与上文提到的图Component16描述的是同一个信号的特征，其周期性得到了更加显著的体现。
除此之外，在前20个主成分中，还存在着众多有明显特征的信号，例如：
![filteredbychannel06](https://user-images.githubusercontent.com/44969208/119221894-2e018380-bb24-11eb-9173-78050b72ea17.png)
![filteredbychannel09](https://user-images.githubusercontent.com/44969208/119221895-2f32b080-bb24-11eb-918b-6c2bead85ce4.png)
![filteredbychannel19](https://user-images.githubusercontent.com/44969208/119221900-32c63780-bb24-11eb-92ae-c023036a6346.png)
这些信号都表现出了一定的周期性，并且在频域上的分布也各不相同，说明这些周期性的干扰信号是广泛存在的，因此，系统的研究这些周期性的干扰信号，是非常有必要的。

3. 在频域内进行主成分分析

由于我们发现了一系列带有周期性质的主成分信号，为了对这种周期信号进行进一步的检验和分析，我们尝试着在频域内进行主成分分析，选取10个数据文件先进行傅里叶变换到频域空间内，然后进行主成分分析，得到的前几个主成分为：
![spectrum01](https://user-images.githubusercontent.com/44969208/119221978-a5cfae00-bb24-11eb-9e01-6d286647e536.png)
![spectrum02](https://user-images.githubusercontent.com/44969208/119221979-a700db00-bb24-11eb-8dc1-87d3efe61c5f.png)
![spectrum03](https://user-images.githubusercontent.com/44969208/119221981-a8ca9e80-bb24-11eb-9d46-5bf3d1ef072a.png)
再后面的信号以白噪声为主，可以看出在频域内进行主成分分析并不能达到我们理想中的效果，经过分析，提出如下可能的原因：
1. 各个频段中采集的频谱样本相差不大，频域内的变化可能没有时域内信号的变化更加显著，协方差矩阵的每个元素相差不大，难以选出更加有特征的成分谱 2. 每个频谱中不同频率的强度相差过大，且波动的规律性更弱 3. 观测到的干扰信号普遍存在与小于0.1Hz的低频部分，而在频谱中观测到了大量的高频成分，这些成分会对低频成分的主成分分析带来强烈的干扰。

## 窄带周期性信号的具体研究

## 总结与讨论



